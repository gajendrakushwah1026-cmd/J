<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JITU | Premium Notes & Video Lectures</title>
    <meta name="description" content="JITU Premium Vault provides high-quality Class 11 Science study material. Get free handwritten notes and HLS video lectures.">
    
    <!-- Google AdSense Main Script -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7037140892556243"
     crossorigin="anonymous"></script>

    <!-- HLS Player Script -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root { --pw-blue: #5a4bda; --bg: #f8f9fd; }
        body { font-family: 'Outfit', sans-serif; background-color: var(--bg); color: #1e2937; margin: 0; overflow-x: hidden; scroll-behavior: smooth; }
        .sub-pill { border: 2px solid #e2e8f0; background: #ffffff; color: #475569; transition: all 0.3s ease; }
        .sub-pill.active { background: var(--pw-blue); color: white; border-color: var(--pw-blue); box-shadow: 0 10px 15px -3px rgba(90, 75, 218, 0.3); transform: translateY(-2px); }
        .glass-nav { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(10px); border-bottom: 1px solid #eef2f6; }
        .video-card { transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1); border: 1px solid #f1f5f9; background: white; border-radius: 28px; overflow: hidden; display: flex; flex-direction: column; height: 100%; }
        .video-card:hover { transform: translateY(-12px); border-color: var(--pw-blue); box-shadow: 0 30px 40px -15px rgba(90, 75, 218, 0.2); }
        .hero-gradient { background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%); }
        #globalLoader { position: fixed; inset: 0; background: #ffffff; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        .spinner { width: 40px; height: 40px; border: 3px solid #f3f3f3; border-top: 3px solid var(--pw-blue); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .shimmer { background: linear-gradient(90deg, #f0f0f0 25%, #f8f8f8 50%, #f0f0f0 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; }
        .desc-text { white-space: pre-wrap; word-wrap: break-word; }
        
        /* Auto Thumbnail Styles */
        .thumb-overlay { background: linear-gradient(to top, rgba(0,0,0,0.8), transparent); }
    </style>
</head>
<body>

<div id="globalLoader">
    <div class="spinner"></div>
    <p class="mt-4 text-[10px] font-black uppercase tracking-widest text-indigo-600"> Please Wait üôè JITU Premium Resources Loading...</p>
</div>

<!-- Navigation -->
<header class="sticky top-0 z-50">
    <nav class="glass-nav px-6 py-4">
        <div class="max-w-7xl mx-auto flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-[#5a4bda] rounded-xl flex items-center justify-center text-white font-black text-xl italic shadow-lg">J</div>
                <div class="flex flex-col">
                    <span class="text-lg font-black tracking-tighter text-gray-900 leading-none uppercase">JITU Premium Resources</span>
                    <span class="text-[8px] font-bold text-indigo-500 uppercase tracking-widest mt-1">Premium Education Material</span>
                </div>
            </div>
            <div class="hidden md:flex gap-8 text-[11px] font-bold uppercase tracking-widest text-gray-500">
                <a href="#explore" class="hover:text-indigo-600">Resources</a>
                <a href="#about-content" class="hover:text-indigo-600">About</a>
                <button onclick="showLegalModal('privacy')" class="hover:text-indigo-600 uppercase">Privacy</button>
            </div>
            <div class="flex items-center gap-2">
                <button id="addBtn" onclick="openAddModal()" class="hidden bg-green-600 text-white px-4 py-2 rounded-lg text-[10px] font-bold uppercase">Add</button>
                <button id="adminBtn" onclick="openLoginModal()" class="bg-gray-100 text-gray-600 px-4 py-2 rounded-lg text-[10px] font-bold uppercase">Admin</button>
            </div>
        </div>
    </nav>
</header>

<!-- Hero Section -->
<section class="hero-gradient pt-24 pb-36 px-6 text-center text-white">
    <div class="max-w-5xl mx-auto">
        <div class="bg-white/10 backdrop-blur-md inline-block px-5 py-2 rounded-full mb-8 border border-white/20">
            <span class="text-[10px] font-black uppercase tracking-widest">üìö Free Premium Education for Class 11</span>
        </div>
        <h1 class="text-5xl md:text-8xl font-black tracking-tighter leading-none mb-8 uppercase italic">
            Free Premium Education <br> <span class="text-indigo-400">Sabke Liye. ‚ò∫Ô∏è</span>
        </h1>
        <div class="max-w-3xl mx-auto space-y-6 text-indigo-100/80 font-medium leading-relaxed">
            <p class="text-lg">
                JITU Premium Resources ek digital library hai jo specially Class 11 Science ke students ki help ke liye banayi gayi hai. Hum Physics, Chemistry, Biology, aur Mathematics ke premium lectures aur notes provide karte hain.
            </p>
        </div>
    </div>
</section>

<!-- Subject Selector -->
<div id="explore" class="bg-white border-b border-gray-100 px-4 py-8 sticky top-[72px] z-40">
    <div class="max-w-7xl mx-auto overflow-x-auto flex gap-4 no-scrollbar" id="subjectList"></div>
</div>

<main class="p-6 md:p-16">
    <div class="max-w-7xl mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-center gap-8 mb-20">
            <div class="text-center md:text-left">
                <h2 id="activeSubjectName" class="text-5xl md:text-7xl font-black text-gray-900 tracking-tighter uppercase italic">Study Materials</h2>
                <p class="text-gray-500 mt-4 font-medium uppercase tracking-widest text-[10px]">Access high-quality educational resources below</p>
            </div>
            <div class="relative w-full md:w-96 group">
                <input id="searchInput" type="text" placeholder="Search Chapters..." class="w-full bg-white border-2 border-gray-100 px-6 py-4 rounded-2xl outline-none focus:border-indigo-500 transition-all shadow-sm">
            </div>
        </div>

        <!-- Optimized About Section for AdSense -->
        <article id="about-content" class="mb-24 prose prose-indigo max-w-none bg-indigo-50/50 p-8 md:p-12 rounded-[2rem] border border-indigo-100">
            <h3 class="text-3xl font-black text-indigo-900 uppercase italic mb-6">About JITU VAULT</h3>
            <div class="grid md:grid-cols-2 gap-10 text-gray-600 leading-relaxed">
                <div>
                    <p class="mb-4"><strong>Quality Education:</strong> Humara mission hai rural aur urban dono areas ke students ko premium quality notes aur video lectures deliver karna.</p>
                    <p><strong>Interactive Learning:</strong> Video lectures aur complex concepts ko easy language mein explain karte hain.</p>
                </div>
                <div>
                    <p class="mb-4"><strong>Free of Cost:</strong> Education resources ke liye hum kabhi koi fees charge nahi karte.</p>
                    <p><strong>Contact Us:</strong> Agar aapko koi dikkat ho rahi hai, toh humare YouTube ya Telegram par reach out karein.</p>
                </div>
            </div>
        </article>
        
        <div id="chaptersContainer" class="space-y-20"></div>
        <div id="emptyState" class="text-center py-40 hidden"><p class="text-2xl font-black text-gray-300 uppercase italic">Updating Content...</p></div>
    </div>
</main>

<!-- Unified Modal System -->
<div id="modalOverlay" class="fixed inset-0 bg-gray-950/90 backdrop-blur-xl hidden z-[100] items-center justify-center p-6 opacity-0 transition-all duration-300">
    <!-- Admin Login -->
    <div id="loginModal" class="bg-white rounded-[2.5rem] w-full max-sm p-10 hidden shadow-2xl">
        <h3 class="text-2xl font-black mb-6 text-center uppercase italic">Admin Access</h3>
        <input id="passInput" type="password" placeholder="Passkey" class="w-full bg-gray-50 p-5 rounded-2xl mb-6 text-center text-2xl font-black border-2 border-gray-100">
        <button onclick="tryLogin()" class="w-full bg-indigo-600 text-white py-5 rounded-2xl font-black uppercase tracking-widest">Verify</button>
    </div>

    <!-- Legal Modal -->
    <div id="legalModal" class="bg-white rounded-[2.5rem] w-full max-w-3xl p-10 hidden max-h-[85vh] overflow-y-auto no-scrollbar">
        <div id="legalContent" class="prose prose-sm max-w-none text-gray-600"></div>
        <div class="mt-8 pt-6 border-t">
            <button onclick="closeModals()" class="w-full bg-indigo-600 text-white py-4 rounded-xl font-black uppercase text-[10px] tracking-widest">Close Page</button>
        </div>
    </div>

    <!-- Content Upload Modal -->
    <div id="addModal" class="bg-white rounded-[2.5rem] w-full max-w-xl p-10 hidden max-h-[90vh] overflow-y-auto no-scrollbar">
        <h3 class="text-3xl font-black mb-8 italic uppercase text-indigo-900">Add Content</h3>
        <div class="space-y-4">
            <input id="vTitle" type="text" placeholder="Lecture Title" class="w-full bg-gray-50 p-5 rounded-2xl border border-gray-100">
            <div class="grid grid-cols-2 gap-4">
                <input id="vSub" type="text" placeholder="Subject" class="w-full bg-gray-50 p-5 rounded-2xl border border-gray-100">
                <input id="vChap" type="text" placeholder="Chapter" class="w-full bg-gray-50 p-5 rounded-2xl border border-gray-100">
            </div>
            <input id="vUrl" type="text" placeholder="M3U8 Video Link" class="w-full bg-gray-50 p-5 rounded-2xl border border-gray-100">
            <div class="grid grid-cols-2 gap-4">
                <input id="vNotes" type="text" placeholder="Lecture Notes PDF Link" class="w-full bg-gray-50 p-5 rounded-2xl border border-gray-100">
                <input id="vChapNotes" type="text" placeholder="Chapter One Pager Link" class="w-full bg-gray-50 p-5 rounded-2xl border border-gray-100">
            </div>
            <textarea id="vCustomDesc" placeholder="AI/Custom Description (Yahan jaisa likhoge waisa hi dikhega)" class="w-full bg-gray-50 p-5 rounded-2xl border border-gray-100 h-32"></textarea>
            <input type="hidden" id="editId">
            <div class="flex gap-4 pt-4">
                <button onclick="closeModals()" class="flex-1 bg-gray-100 py-5 rounded-2xl font-bold uppercase text-xs">Cancel</button>
                <button onclick="saveVideo()" class="flex-[2] bg-indigo-600 text-white py-5 rounded-2xl font-black uppercase text-xs">Save Content</button>
            </div>
        </div>
    </div>

    <!-- Video Player Modal -->
    <div id="playerModal" class="bg-black rounded-3xl w-full max-w-4xl overflow-hidden hidden shadow-2xl relative">
        <button onclick="closeModals()" class="absolute top-4 right-4 z-50 bg-white/20 text-white p-2 rounded-full hover:bg-white/40">‚úï</button>
        <div class="aspect-video bg-black flex items-center justify-center">
            <video id="hlsVideo" controls autoplay playsinline class="w-full h-full"></video>
        </div>
    </div>
</div>

<footer class="bg-white border-t border-gray-100 pt-24 pb-12 px-8">
    <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-16">
        <div class="md:col-span-2">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-8 h-8 bg-[#5a4bda] rounded-lg flex items-center justify-center text-white font-black text-lg italic">J</div>
                <span class="text-lg font-black tracking-tighter uppercase">JITU VAULT</span>
            </div>
            <p class="text-gray-500 text-sm leading-relaxed max-w-md italic">A dedicated educational hub for Class 11 Science students. Empowering learners with premium resources for free.</p>
        </div>
        <div>
            <h4 class="font-black text-[10px] uppercase tracking-widest text-gray-900 mb-6">Policies</h4>
            <ul class="space-y-4 text-xs font-bold text-gray-400 uppercase tracking-widest">
                <li><button onclick="showLegalModal('privacy')" class="hover:text-indigo-600">Privacy Policy</button></li>
                <li><button onclick="showLegalModal('terms')" class="hover:text-indigo-600">Terms of Service</button></li>
            </ul>
        </div>
        <div>
            <h4 class="font-black text-[10px] uppercase tracking-widest text-gray-900 mb-6">Social</h4>
            <ul class="space-y-4 text-xs font-bold text-gray-400 uppercase tracking-widest">
                <li><a href="#" class="hover:text-red-500">YouTube</a></li>
                <li><a href="#" class="hover:text-blue-500">Telegram</a></li>
            </ul>
        </div>
    </div>
    <div class="mt-20 pt-8 border-t text-center"><p class="text-[9px] text-gray-400 font-bold uppercase tracking-[0.3em]">¬© 2024 JITU EDUCATIONAL HUB</p></div>
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
import { getFirestore, collection, addDoc, onSnapshot, deleteDoc, doc, updateDoc } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";
import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyB1bJg4JrtFmceuAZvJaMXgUUhxCf1UKdo",
  authDomain: "not-13c89.firebaseapp.com",
  projectId: "not-13c89",
  storageBucket: "not-13c89.firebasestorage.app",
  messagingSenderId: "684410233370",
  appId: "1:684410233370:web:0ed671c584120a4fc1a7a3"
};

let db, auth, videoList = [], isAdmin = false, currentSubject = '';
const PASS_KEY = "Jitu9027", COLLECTION_ID = "jitu_ultra_premium_v2";
const SUBJECT_ORDER = ["Physics", "Chemistry", "Maths", "Biology", "English"];
let hlsInstance = null;

const LEGAL_DATA = {
    privacy: `<h2 class="text-2xl font-black mb-4 uppercase">Privacy Policy</h2><p>JITU VAULT aapki privacy ka dhyan rakhta hai. Hum personal data collect nahi karte aur Google AdSense cookies use karta hai.</p>`,
    terms: `<h2 class="text-2xl font-black mb-4 uppercase">Terms of Service</h2><p>Content sirf educational purpose ke liye hai. Commercial use allowed nahi hai.</p>`,
    disclaimer: `<h2 class="text-2xl font-black mb-4 uppercase">Disclaimer</h2><p>Hum official board se nahi jude hain. Data students ki help ke liye hai.</p>`
};

// Helper to sort strings naturally (Chapter 1, Chapter 2, Chapter 10, Lecture 1, Lecture 2...)
const naturalSort = (a, b) => {
    return a.localeCompare(b, undefined, { numeric: true, sensitivity: 'base' });
};

async function startup() {
    const app = initializeApp(firebaseConfig);
    db = getFirestore(app); auth = getAuth(app);
    await signInAnonymously(auth);
    onAuthStateChanged(auth, user => { if(user) listen(); });
}

function listen() {
    onSnapshot(collection(db, 'artifacts', COLLECTION_ID, 'public', 'data', 'videos'), snap => {
        const rawData = snap.docs.map(d => ({ id: d.id, ...d.data() }));
        // Base sorting by creation to keep some stability, but render() handles complex sequence
        videoList = rawData.sort((a, b) => (a.createdAt || 0) - (b.createdAt || 0));
        
        if(videoList.length > 0 && !currentSubject) {
            const availableSubs = [...new Set(videoList.map(v => v.subject))];
            currentSubject = SUBJECT_ORDER.find(s => availableSubs.includes(s)) || availableSubs[0];
        }
        document.getElementById('globalLoader')?.remove();
        render();
    });
}

window.playVideo = (url) => {
    const video = document.getElementById('hlsVideo');
    if (!video) return;
    showModal('playerModal');
    if (hlsInstance) { hlsInstance.destroy(); hlsInstance = null; }

    if (Hls.isSupported()) {
        hlsInstance = new Hls();
        hlsInstance.loadSource(url);
        hlsInstance.attachMedia(video);
        hlsInstance.on(Hls.Events.MANIFEST_PARSED, () => video.play().catch(e => {}));
    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = url;
        video.addEventListener('loadedmetadata', () => video.play());
    }
};

window.render = () => {
    const subList = document.getElementById('subjectList');
    const chaptersCont = document.getElementById('chaptersContainer');
    const search = document.getElementById('searchInput').value.toLowerCase();
    if (!subList || !chaptersCont) return;

    if (isAdmin) document.getElementById('addBtn').classList.remove('hidden');

    const uniqueSubs = [...new Set(videoList.map(v => v.subject))].sort((a,b) => SUBJECT_ORDER.indexOf(a) - SUBJECT_ORDER.indexOf(b));
    subList.innerHTML = uniqueSubs.map(s => `<button onclick="selectSubject('${s}')" class="sub-pill px-10 py-4 rounded-full text-[10px] font-black uppercase whitespace-nowrap transition-all ${currentSubject === s ? 'active' : ''}">${s}</button>`).join('');
    
    document.getElementById('activeSubjectName').innerText = currentSubject || "Study Materials";
    
    // Filter videos by current subject and search
    let subVideos = videoList.filter(v => v.subject === currentSubject && v.title.toLowerCase().includes(search));
    
    // SEQUENCE FIX: Sort all subVideos by Title first to handle L1, L2, L3 sequence
    subVideos.sort((a, b) => naturalSort(a.title, b.title));
    
    // CHAPTER SEQUENCE FIXED: Use natural sort for chapter names
    const chapters = [...new Set(subVideos.map(v => v.chapter || 'General'))].sort(naturalSort);

    document.getElementById('emptyState').classList.toggle('hidden', subVideos.length > 0);

    chaptersCont.innerHTML = chapters.map(chap => {
        const chapVideos = subVideos.filter(v => (v.chapter || 'General') === chap);
        const chapOnePager = chapVideos.find(v => v.chapNotes)?.chapNotes;

        return `
            <div>
                <div class="flex items-center gap-6 mb-12 flex-wrap">
                    <h3 class="text-3xl font-black text-gray-900 uppercase italic tracking-tighter">${chap}</h3>
                    ${chapOnePager ? `
                        <button onclick="window.open('${chapOnePager}')" class="bg-indigo-50 text-indigo-600 px-4 py-2 rounded-xl text-[9px] font-black uppercase tracking-widest border border-indigo-100 hover:bg-indigo-100 transition-colors">üìÑ Chapter One Pager</button>
                    ` : ''}
                    <div class="flex-1 h-[1px] bg-gray-100 min-w-[50px]"></div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    ${chapVideos.map(v => `
                        <div class="video-card group">
                            <div class="aspect-video cursor-pointer relative overflow-hidden bg-indigo-950" onclick="playVideo('${v.m3u8Url}')">
                                <div class="absolute inset-0 flex items-center justify-center">
                                    <div class="text-center p-6 select-none">
                                        <p class="text-[10px] font-black text-indigo-400 uppercase tracking-widest mb-1 opacity-60">${v.subject} - ${v.chapter}</p>
                                        <p class="text-white text-xl font-black italic uppercase leading-none px-4 opacity-80">${v.title}</p>
                                    </div>
                                </div>
                                <div class="absolute inset-0 thumb-overlay opacity-40"></div>
                                <div class="absolute inset-0 flex items-center justify-center z-10">
                                    <div class="w-14 h-14 bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center group-hover:scale-110 group-hover:bg-indigo-600 transition-all duration-300">
                                        <div class="border-y-8 border-y-transparent border-l-[14px] border-l-white ml-1"></div>
                                    </div>
                                </div>
                                <div class="absolute bottom-4 left-4 z-20 text-[8px] font-black text-white/40 uppercase tracking-widest">Premium JITU Stream</div>
                            </div>
                            <div class="p-8 flex-1 flex flex-col">
                                <h4 class="text-lg font-black text-gray-900 mb-3 uppercase leading-tight">${v.title}</h4>
                                <p class="desc-text text-[11px] text-gray-500 mb-6 leading-relaxed font-medium flex-1">
                                    ${v.customDescription || 'Quality premium education material for class 11th students.'}
                                </p>
                                <div class="flex items-center gap-3">
                                    <button onclick="playVideo('${v.m3u8Url}')" class="flex-1 bg-indigo-600 text-white text-[9px] font-black py-4 rounded-xl uppercase shadow-lg shadow-indigo-100">Play Lecture</button>
                                    ${v.notes ? `<button onclick="window.open('${v.notes}')" class="px-5 py-4 bg-gray-100 text-gray-600 rounded-xl text-[9px] font-black uppercase">Notes</button>` : ''}
                                </div>
                                ${isAdmin ? `<div class="mt-4 pt-4 border-t flex gap-4 text-[9px] font-bold uppercase"><button onclick="editEntry('${v.id}')" class="text-indigo-400">Edit</button><button onclick="deleteMe('${v.id}')" class="text-red-400">Delete</button></div>` : ''}
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    }).join('');
};

window.saveVideo = async () => {
    const title = document.getElementById('vTitle').value, sub = document.getElementById('vSub').value, chap = document.getElementById('vChap').value;
    const m3u8Url = document.getElementById('vUrl').value, notes = document.getElementById('vNotes').value, editId = document.getElementById('editId').value;
    const chapNotes = document.getElementById('vChapNotes').value;
    const customDesc = document.getElementById('vCustomDesc').value;
    
    if(title && m3u8Url) {
        const data = { title, subject: sub, chapter: chap || 'General', m3u8Url, notes, chapNotes, customDescription: customDesc, updatedAt: Date.now() };
        if(editId) await updateDoc(doc(db, 'artifacts', COLLECTION_ID, 'public', 'data', 'videos', editId), data);
        else await addDoc(collection(db, 'artifacts', COLLECTION_ID, 'public', 'data', 'videos'), { ...data, createdAt: Date.now() });
        closeModals();
    } else alert("Details missing!");
};

window.editEntry = (id) => {
    const v = videoList.find(i => i.id === id);
    document.getElementById('editId').value = v.id;
    document.getElementById('vTitle').value = v.title;
    document.getElementById('vSub').value = v.subject;
    document.getElementById('vChap').value = v.chapter;
    document.getElementById('vUrl').value = v.m3u8Url || "";
    document.getElementById('vNotes').value = v.notes || "";
    document.getElementById('vChapNotes').value = v.chapNotes || "";
    document.getElementById('vCustomDesc').value = v.customDescription || "";
    showModal('addModal');
};

window.showLegalModal = (type) => {
    document.getElementById('legalContent').innerHTML = LEGAL_DATA[type];
    showModal('legalModal');
};

window.deleteMe = async (id) => { if(confirm("Delete?")) await deleteDoc(doc(db, 'artifacts', COLLECTION_ID, 'public', 'data', 'videos', id)); };
window.selectSubject = (s) => { currentSubject = s; render(); };
window.tryLogin = () => { if(document.getElementById('passInput').value === PASS_KEY) { isAdmin = true; closeModals(); render(); } };
window.showModal = (id) => { 
    const o = document.getElementById('modalOverlay'); 
    o.classList.remove('hidden'); o.classList.add('flex'); 
    document.getElementById(id).classList.remove('hidden'); 
    setTimeout(() => o.style.opacity = '1', 50); 
};
window.closeModals = () => { 
    const video = document.getElementById('hlsVideo');
    if (video) { video.pause(); video.src = ""; }
    if (hlsInstance) { hlsInstance.destroy(); hlsInstance = null; }
    document.getElementById('modalOverlay').style.opacity = '0'; 
    setTimeout(() => {
        document.getElementById('modalOverlay').classList.add('hidden');
        ['loginModal','addModal','legalModal','playerModal'].forEach(m => document.getElementById(m).classList.add('hidden'));
    }, 300); 
};
window.openLoginModal = () => isAdmin ? (isAdmin = false, location.reload()) : showModal('loginModal');
window.openAddModal = () => { ['vTitle','vUrl','vSub','vChap','vNotes','vChapNotes','vCustomDesc','editId'].forEach(i=>document.getElementById(i).value=""); showModal('addModal'); };
document.getElementById('searchInput').addEventListener('input', render);
startup();
</script>
</body>
    </html>
